<link rel="import" href="zeppelin-paragraph/zeppelin-paragraph.html">
<!-- <link rel="import" href="../zeppelin-chart-manager.html"> -->
<dom-module id="zeppelin-notebook">
  <template>
    <style>
    :host {
      display: block;
      margin-top: 0em;
    }
    
    section {
      background: #ffffff;
      margin: 0;
      padding: 0 1em;
      display: flex;
    }
    
    section h3 {
      margin-top: 11px;
    }
    
    .name-wrap {
      flex-grow: 1;
    }
    
    .notebook-settings {
      display: flex;
    }
    </style>
    <!--  <paper-dialog modal id="interPreterDialog" dynamic-align>
                <h2>Interpreter binding</h2>
                <paper-dialog-scrollable>
                    <ul>
                    <template is="dom-repeat" items="[[notebook.interpreters]]">
                        <li>[[item.name]]</li>
                    </template>
                    </ul>
                </paper-dialog-scrollable>
                <div class="buttons">
                    <paper-button class="cancel" dialog-dismiss>Cancel</paper-button>
                    <paper-button on-tap="createNoteBook">Save</paper-button>
                </div>
            </paper-dialog> -->
    <!-- <template is="dom-if" if="{{ !viewMode }}" restamp>
            <section class="title">
                <div class="name-wrap">
                    <template is="dom-if" if="[[ !editNotebook ]]">
                        <h3 title="Click to edit" on-tap="renameNotebook">Notebook: {{ notebook.name }}</h3>
                    </template>
                    <template is="dom-if" if="[[ editNotebook ]]">
                        <paper-input value="{{ notebook.name }}"></paper-input>
                        <paper-icon-button icon="icons:done" class="save-btn" on-tap="saveNoteBookName"></paper-icon-button>
                        <paper-icon-button icon="icons:clear" class="clear-btn" on-tap="cancelRename"></paper-icon-button>
                    </template>
                </div>
                <div class="icons notebook-settings">
                    <paper-icon-button icon="icons:done-all" on-tap="runAllParas" title="Run all paragraphs"></paper-icon-button>
                    <paper-icon-button icon="icons:settings" on-tap="showInterpreters" title="Interpreters"></paper-icon-button>
                    <template is="dom-if" if="[[ expandAll ]]">
                        <paper-icon-button icon="dashboard" on-tap="showToggle" title="Collapse All"></paper-icon-button>
                    </template>
                    <template is="dom-if" if="[[ !expandAll ]]">
                        <paper-icon-button icon="apps" on-tap="showToggle" title="Expand All"></paper-icon-button>
                    </template>
                </div>
            </section>
            
        </template> -->
    <!-- <div class$="view-mode-[[ viewMode]]"> -->
    <!-- <template is="dom-if" if="{{ viewMode }}" restamp> -->
    <h3>{{ notebook.name }}</h3>
    <!-- </template> -->
    <template is="dom-repeat" items="[[ paragraphs ]]">
      <zeppelin-paragraph index="[[ index]]" last-Item="{{isLast(index)}}" show-code="[[showCode]]"> </zeppelin-paragraph>
    </template>
    <!-- </div> -->
  </template>
  <script>
  class ZeppelinNotebook extends ZeppelinReduxMixin(Polymer.Element) {
    static get is() {
      return 'zeppelin-notebook'
    }
    static get properties() {
      return {
        showCode: {
          type: Boolean,
          value: true
            // ,statePath:'notebook.showCode'
        },
        notebook: {
          type: Object,
          statePath:'notebook'
        },
        paragraphs:{
          type:Array,
          statePath(state){
            return state.notebook.paragraphs
          }
        },
        selectedGroup: {
          type: Object,
          statePath: 'selectedItem'
        }
      }
    }
    static get observers() {
      return ['getNotebook(selectedGroup)']
    }
    constructor() {
      super()
    }
    isLast(index){
          return index== this.paragraphs.length
    }
    getNotebook(id) {
      var data = {
        op: 'GET_NOTE',
        data: {
          id: id
        }
      };
      this.dispatch({
        type: 'WS_POST',
        payload: data
      });
      // this.set('wsData', data);
    }
  }
  window.customElements.define(ZeppelinNotebook.is, ZeppelinNotebook);
  </script>
</dom-module>
